package fr.aragot.util;

import java.io.BufferedReader;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.StandardOpenOption;
import java.util.Scanner;

public class ExploitationLog {

	private static final Scanner sc = new Scanner(System.in);
	public static void main(String[] args) {
		System.out.println("Entrez le nom du fichier à convertir :");
		
		Path logFile = Path.of("resources\\"+sc.nextLine());
		
		StringBuffer sb = null;
		
		try (BufferedReader br = Files.newBufferedReader(logFile)) {
			String l = null;
			sb = new StringBuffer();
			sb.append("IP; Heure de connexion; URI\n");
			while ((l = br.readLine()) != null) {
				String[] sL = l.split(",");
				sb.append(String.format("%s; %s %s; %s\n", sL[0], sL[2], sL[3], sL[13]));
			}
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();

		}

		Path output = Path.of("resources\\Copie de "+ logFile.getFileName().toString());
		try {
			Files.writeString(output, sb.toString(), StandardCharsets.UTF_8, StandardOpenOption.CREATE, StandardOpenOption.TRUNCATE_EXISTING);

			System.out.println(output.getFileName() + " a été créé.");
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	}
	
	
	
	

}
